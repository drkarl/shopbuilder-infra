# CI Environment - Example Variables
# Copy to terraform.tfvars and customize
#
# EPHEMERAL RUNNER WORKFLOW
# =========================
# This runner is designed to be created on-demand and destroyed when idle.
# Hetzner bills by the hour, so destroying the server completely stops billing.
#
# Quick start:
#   terraform apply                    # Create runner (~2-3 min)
#   <run your CI jobs>
#   terraform destroy                  # Stop billing
#
# For burst capacity (parallel jobs):
#   terraform apply -var="server_size=burst"

project_name = "shopbuilder"
runner_name  = "github-runner-1"

#------------------------------------------------------------------------------
# Server Size (choose one)
#------------------------------------------------------------------------------

# "small" (default) - Good for single CI jobs, sequential builds
#   cpx32: 4 vCPU (shared), 8GB RAM, 160GB NVMe
#   Cost: ~€0.015/hour = €0.36/day if running 24h
server_size = "small"

# "burst" - Good for parallel jobs, Docker builds, or heavy compilation
#   cpx42: 8 vCPU (shared), 16GB RAM, 320GB NVMe
#   Cost: ~€0.028/hour = €0.67/day if running 24h
# server_size = "burst"

# "custom" - Use server_type directly (uncomment both lines)
# server_size = "custom"
# server_type = "ccx23"  # Example: 4 dedicated vCPU, 16GB RAM

location = "nbg1"  # Nuremberg, Germany (or hel1 for Helsinki)

#------------------------------------------------------------------------------
# SSH Configuration
#------------------------------------------------------------------------------

# SSH public key - REQUIRED
# Get from: cat ~/.ssh/hetzner_id_ed25519.pub
ssh_public_key = "ssh-ed25519 AAAA... your-key-here"
ssh_key_name   = "github-runner-key"

# Optional: restrict SSH to your IP only (recommended for security)
# ssh_allowed_ips = ["YOUR.IP.ADDRESS/32"]

#------------------------------------------------------------------------------
# Runner Configuration
#------------------------------------------------------------------------------

runner_user   = "runner"
runner_labels = ["self-hosted", "linux", "x64", "hetzner", "builder"]

# Java version for Gradle builds
java_version = 25

# Install Docker for building images
install_docker = true

#------------------------------------------------------------------------------
# GitHub Auto-Registration (Optional but Recommended for Ephemeral)
#------------------------------------------------------------------------------
# For ephemeral runners, auto-registration is HIGHLY recommended because:
# - Manual registration requires SSH + copy/paste token after each `terraform apply`
# - Auto-registration makes `terraform apply` fully automated
#
# Trade-off: Requires a GitHub PAT stored in terraform.tfvars (gitignored)

# Option A: Manual registration (default)
#   After terraform apply:
#     1. SSH to runner: terraform output -raw ssh_command
#     2. Get token from: https://github.com/<owner>/<repo>/settings/actions/runners/new
#     3. Run: ./install-runner.sh <TOKEN> https://github.com/drkarl/shop-builder
auto_register_runner = false

# Option B: Automatic registration (recommended for ephemeral workflow)
#   Uncomment and fill in:
# auto_register_runner = true
# github_token         = "ghp_xxxxxxxxxxxx"  # PAT with 'repo' scope
# github_owner         = "drkarl"
# github_repository    = "shop-builder"
#
# Get a PAT from: https://github.com/settings/tokens/new?scopes=repo
# Security: The PAT is only used to get a short-lived registration token.
#           It's stored locally in terraform.tfvars (gitignored).
