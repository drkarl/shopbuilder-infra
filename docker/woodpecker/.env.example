# Woodpecker CI Environment Configuration
# Copy this file to .env and fill in the values
#
# For production, store secrets in SOPS-encrypted files (see docs/secrets-management.md)

# =============================================================================
# Woodpecker Version
# =============================================================================
# Pin to a specific version for reproducible deployments
# See: https://hub.docker.com/r/woodpeckerci/woodpecker-server/tags
WOODPECKER_VERSION=latest

# =============================================================================
# Server Configuration
# =============================================================================
# Public URL where Woodpecker is accessible (used for OAuth callbacks)
# REQUIRED: Set this to your domain, e.g., https://ci.example.com
WOODPECKER_HOST=

# Allow anyone to sign up (set to false for private instances)
WOODPECKER_OPEN=false

# Comma-separated list of admin usernames (GitHub usernames)
WOODPECKER_ADMIN=

# =============================================================================
# Agent Secret (REQUIRED)
# =============================================================================
# Shared secret between server and agents for authentication
# Generate with: openssl rand -hex 32
# REQUIRED: All agents must use the same secret to connect
WOODPECKER_AGENT_SECRET=

# =============================================================================
# GitHub OAuth Application
# =============================================================================
# Create a GitHub OAuth App: https://github.com/settings/developers
# Authorization callback URL: ${WOODPECKER_HOST}/authorize
#
# REQUIRED: GitHub OAuth client ID
WOODPECKER_GITHUB_CLIENT=
# REQUIRED: GitHub OAuth client secret
WOODPECKER_GITHUB_SECRET=

# Enable GitHub integration (default: true)
WOODPECKER_GITHUB=true

# =============================================================================
# Database Configuration
# =============================================================================
# SQLite (default, suitable for small deployments)
WOODPECKER_DATABASE_DRIVER=sqlite3
WOODPECKER_DATABASE_DATASOURCE=/var/lib/woodpecker/woodpecker.sqlite

# PostgreSQL (recommended for production)
# WOODPECKER_DATABASE_DRIVER=postgres
# WOODPECKER_DATABASE_DATASOURCE=postgres://user:password@host:5432/woodpecker?sslmode=require

# =============================================================================
# Port Configuration
# =============================================================================
# HTTP port for web UI and API
WOODPECKER_HTTP_PORT=8000

# gRPC port for agent connections
WOODPECKER_GRPC_PORT=9000

# =============================================================================
# Agent Configuration
# =============================================================================
# Server address for agents to connect to (internal network address)
# When using Docker Compose, use the service name
WOODPECKER_SERVER=woodpecker-server:9000

# Agent hostname identifier (shows in server UI)
WOODPECKER_AGENT_HOSTNAME=agent-1

# Maximum concurrent workflows per agent
# Increase for agents with more resources
WOODPECKER_MAX_WORKFLOWS=1

# =============================================================================
# Logging
# =============================================================================
# Log level: trace, debug, info, warn, error, fatal, panic
WOODPECKER_LOG_LEVEL=info

# =============================================================================
# Resource Limits - Server
# =============================================================================
WOODPECKER_SERVER_CPU_LIMIT=1.0
WOODPECKER_SERVER_MEMORY_LIMIT=512M
WOODPECKER_SERVER_CPU_RESERVATION=0.25
WOODPECKER_SERVER_MEMORY_RESERVATION=128M

# =============================================================================
# Resource Limits - Agent
# =============================================================================
# Agents need more resources as they run build containers
# Adjust based on your typical build workloads
WOODPECKER_AGENT_CPU_LIMIT=2.0
WOODPECKER_AGENT_MEMORY_LIMIT=4G
WOODPECKER_AGENT_CPU_RESERVATION=0.5
WOODPECKER_AGENT_MEMORY_RESERVATION=512M
